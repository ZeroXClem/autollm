import os
import yaml

def create_sweep_workflow():
    workflow = {
        "name": "Sweep",
        "on": {
                "push": {
                    "branches": ["main"]
                }
            },
            "pull_request": {
            {
                "push":
                    {
                        "branches": ["main"]
                    }
            },
        "jobs":
            {
                "sweep_job":
                    {
                        "runs-on": "ubuntu-latest",
        "if": "github.event_name == 'push' && github.ref == 'refs/heads/main'",
                        "steps":
                            [
                                {
                                    "name": "Checkout repository",
                                    "uses": "actions/checkout@v2"
                                },
                                {
                                    "name": "Set up Python",
                                    "uses": "actions/setup-python@v2", "with": {"python-version": "3.x"},
                                    "with": {
                                    "python-version": "3.x"
                                },
                                {
                                    "name": "Install dependencies",
                                    "run": "pip install -r requirements.txt",
                                    "working-directory": "app"
                                ,
                                {
                                    "name": "Install dependencies",
                                    "run": "pip install -r requirements.txt",
                                    "working-directory": "app"
                                }
                                        }
                                },
                                {
                                    "name": "Run sweep script",
                                    "run": "python sweep.py", "working-directory": "app"
                                }
                            ]
                    }
            }
    }

    with open(".github/workflows/sweep.yml", "w") as file:
        yaml.dump(workflow, file)

create_sweep_workflow()
